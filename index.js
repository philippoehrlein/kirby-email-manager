(function(){"use strict";const e=window.Vue;function u(){return window.panel}const c=e.computed;e.customRef,e.defineAsyncComponent,e.defineComponent,e.effectScope,e.getCurrentInstance,e.getCurrentScope,e.h,e.inject,e.isProxy,e.isReactive,e.isReadonly,e.isRef,e.isShallow,e.markRaw,e.nextTick,e.onActivated,e.onBeforeMount,e.onBeforeUnmount,e.onBeforeUpdate,e.onDeactivated,e.onErrorCaptured,e.onMounted,e.onRenderTracked,e.onRenderTriggered,e.onScopeDispose,e.onServerPrefetch,e.onUnmounted,e.onUpdated,e.provide,e.proxyRefs,e.reactive,e.readonly;const v=e.ref;e.shallowReactive,e.shallowReadonly,e.shallowRef,e.toRaw,e.toRef,e.toRefs,e.triggerRef,e.unref,e.useAttrs,e.useCssModule,e.useCssVars,e.useListeners,e.useSlots,e.watch,e.watchEffect,e.watchPostEffect,e.watchSyncEffect;const f=Vue.defineComponent({__name:"BuyActivateButtons",emits:["activated"],setup(i,{emit:t}){const a=u(),n=Vue.ref(null),l="https://email-manager.philippoehrlein.de#buy";return Vue.onMounted(async()=>{try{const s=await a.api.get("email-manager/license/status");n.value=!!(s!=null&&s.activated),t("activated",n.value)}catch(s){console.error(s),n.value=!1}a.events.on("license.activated",()=>{n.value=!0,t("activated",n.value)})}),{__sfc:!0,emit:t,panel:a,activated:n,buyurl:l}}});function p(i,t,a,n,l,s,d,_){var o=typeof i=="function"?i.options:i;return t&&(o.render=t,o.staticRenderFns=a,o._compiled=!0),s&&(o._scopeId="data-v-"+s),{exports:i,options:o}}var h=function(){var t=this,a=t._self._c,n=t._self._setupProxy;return n.activated===!1?a("k-button-group",{attrs:{layout:"collapsed"}},[a("k-button",{attrs:{variant:"filled",icon:"cart",theme:"pink",size:"sm",link:n.buyurl,target:"_blank"}},[t._v(" "+t._s(n.panel.t("philippoehrlein.kirby-email-manager.activate-section.button.buy"))+" ")]),a("k-button",{attrs:{variant:"filled",icon:"key",theme:"pink",size:"sm",dialog:"email-manager/license/activation"}},[t._v(" "+t._s(n.panel.t("activate"))+" ")])],1):t._e()},g=[],y=p(f,h,g,!1,null,null);const b=y.exports,k=Vue.defineComponent({__name:"EmailManagerBlock",props:{content:null,tabs:null},setup(i){const t=i,a=u(),n=c(()=>t.content),l=c(()=>t.tabs),s=c(()=>{const r=l.value.email.fields.email_templates.options.find(E=>E.value===n.value.email_templates);return r?r.text:!1}),d=c(()=>!n.value.send_to_more),_=()=>{var r;return d.value?!!n.value.send_to:(((r=n.value.send_to_structure)==null?void 0:r.length)??0)>0},o=()=>!!(n.value.send_to_success_title&&n.value.send_to_success_text),m=()=>n.value.gdpr_checkbox?n.value.gdpr_text.length>0:!0,B=c(()=>({emailTemplate:!!n.value.email_templates,recipients:_(),successMessage:o(),gdpr:m()})),T=c(()=>m()),$=c(()=>({emailTemplate:a.t("philippoehrlein.kirby-email-manager.panel.status.email_template"),recipients:a.t("philippoehrlein.kirby-email-manager.panel.status.recipients"),successMessage:a.t("philippoehrlein.kirby-email-manager.panel.status.success_message")}));return{__sfc:!0,props:t,panel:a,computedContent:n,tabs:l,selectedEmailTemplate:s,isSingleEmail:d,validateRecipients:_,validateSuccessMessage:o,validateGdpr:m,validationRules:B,isGdprValid:T,statusItems:$}}});var R=function(){var t=this,a=t._self._c,n=t._self._setupProxy;return a("div",{staticClass:"k-block"},[a("k-block-title",{attrs:{fieldset:{icon:"email-manager",name:"Email Manager",label:n.selectedEmailTemplate??!1}}}),a("ul",{staticClass:"email-status-list"},[t._l(n.statusItems,function(l,s){return a("li",{key:s},[a("k-icon",{attrs:{type:n.validationRules[s]?"check":"cancel",color:n.validationRules[s]?"positive":"negative"}}),t._v(" "+t._s(l)+" ")],1)}),t.content.gdpr_checkbox?a("li",[a("k-icon",{attrs:{type:n.isGdprValid?"check":"cancel",color:n.isGdprValid?"positive":"negative"}}),t._v(" "+t._s(n.panel.t("philippoehrlein.kirby-email-manager.panel.status.gdpr"))+" ")],1):t._e()],2),a("buy-activate-buttons")],1)},L=[],w=p(k,R,L,!1,null,"96f01ef7");const C=w.exports,V=Vue.defineComponent({__name:"LicenseSection",setup(i){const t=u(),a=v(!1);return{__sfc:!0,panel:t,isActivated:a,setActivated:l=>{a.value=l}}}});var M=function(){var t=this,a=t._self._c,n=t._self._setupProxy;return n.isActivated?t._e():a("div",{staticClass:"license-section"},[a("div",{staticClass:"license-section-header"},[a("k-icon",{attrs:{type:"key",color:"pink-600"}}),a("h1",[t._v(t._s(n.panel.t("philippoehrlein.kirby-email-manager.panel.license.headline")))])],1),a("buy-activate-buttons",{on:{activated:n.setActivated}})],1)},x=[],S=p(V,M,x,!1,null,"294db00d");const A=S.exports;window.panel.plugin("philippoehrlein/kirby-email-manager",{icons:{"email-manager":'<path fill-rule="evenodd" clip-rule="evenodd" d="M12 0L0 6V18L12 24L24 18V6L12 0ZM12.0002 2.73176L2.73187 7.3659V16.6342L12.0002 21.2683L21.2685 16.6342V7.3659L12.0002 2.73176ZM12.0002 4.80421L5.94995 7.82932L12.0002 10.8544L18.0504 7.82932L12.0002 4.80421ZM19.4148 15.4886V9.21956L12.0002 12.9269L4.58553 9.21956V15.4886L12.0002 19.1959L19.4148 15.4886Z" fill="currentColor"/>'},blocks:{"email-manager":C},components:{"buy-activate-buttons":b},sections:{"email-manager-license":A}})})();
